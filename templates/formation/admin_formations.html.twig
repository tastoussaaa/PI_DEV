{% extends 'base.html.twig' %}

{% block title %}Gestion des formations
{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('assets/css/medecin/dashboard.css') }}">
{% endblock %}

{% block body %}
	{% set navigation = [
    {'name': 'Formations', 'path': path('admin_formations'), 'icon': 'üìö'},
] %}
	<div class="portal">
		{% include 'side_bar.html.twig' %}

		<main class="portal__main">
			<div class="portal__top">
				<h1 class="portal__title">Gestion des formations</h1>
				<p class="portal__subtitle">Valider ou refuser les formations propos√©es</p>
			</div>

			<div class="box">
				<table class="portal__table">
					<thead>
						<tr>
							<th>Titre</th>
							<th>Cat√©gorie</th>
							<th>Date</th>
							<th>Statut</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for formation in formations %}
							<tr>
								<td>{{ formation.title }}</td>
								<td>{{ formation.category }}</td>
								<td>{{ formation.startDate|date('d/m/Y') }}</td>
								<td>
									{% if formation.statut == constant('App\\Entity\\Formation::STATUT_VALIDE') %}
										<span class="status status--success">Valid√©e</span>
									{% elseif formation.statut == constant('App\\Entity\\Formation::STATUT_REFUSE') %}
										<span class="status status--danger">Refus√©e</span>
									{% else %}
										<span class="status status--warning">En attente</span>
									{% endif %}
								</td>
								<td>
									{% if formation.statut|upper == constant('App\\Entity\\Formation::STATUT_EN_ATTENTE') %}
										<div style="display:flex; gap:6px;">
											<form method="post" action="{{ path('admin_formation_update_status', {id: formation.id}) }}">
												<input type="hidden" name="statut" value="{{ constant('App\\Entity\\Formation::STATUT_VALIDE') }}">
												<input type="hidden" name="_token" value="{{ csrf_token('update-status-' ~ formation.id) }}">
												<button class="btn btn--primary">‚úÖ Valider</button>
											</form>

											<form method="post" action="{{ path('admin_formation_update_status', {id: formation.id}) }}">
												<input type="hidden" name="statut" value="{{ constant('App\\Entity\\Formation::STATUT_REFUSE') }}">
												<input type="hidden" name="_token" value="{{ csrf_token('update-status-' ~ formation.id) }}">
												<button class="btn btn--danger">‚ùå Refuser</button>
											</form>
										</div>
									{% else %}
										‚Äî
									{% endif %}
								</td>

							</tr>
						{% else %}
							<tr>
								<td colspan="5" style="text-align:center;">Aucune formation disponible</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</main>
	</div>
{% endblock %}
