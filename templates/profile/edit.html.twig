{% extends 'base.html.twig' %}

{% block title %}Modifier mon Profil{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('assets/css/medecin/dashboard.css') }}">
{% endblock %}


{% block javascripts %}
    <script src="{{ asset('public/assets/js/controle.js') }}" defer></script>
{% endblock %}

{% block body %}
<div class="portal">
    {% include 'side_bar.html.twig' %}

    <main class="portal__main">
        <div class="portal__top">
            <div>
                <h1 class="portal__title">Modifier mon Profil</h1>
                <p class="portal__subtitle">Mettez √† jour vos informations personnelles</p>
            </div>
            <a href="{{ path('profile_index') }}" class="btn btn--ghost">
                ‚Üê Retour au profil
            </a>
        </div>

        <div class="portal__content">
            {% if success %}
            <div class="pill" style="margin-bottom: 2rem;">
                ‚úì {{ success }}
            </div>
            {% endif %}

            {% if error %}
            <div class="pill" style="margin-bottom: 2rem;">
                ‚úï {{ error }}
            </div>
            {% endif %}

            <div class="box">
                <form method="post">
                    <div class="profile-info">
                        <!-- Informations de base -->
                        <div class="profile-info-item">
                            <label class="profile-info-label">Nom complet</label>
                            <div class="form-group">
                                <input type="text" name="fullName" value="{{ user.fullName }}">
                            </div>
                        </div>

                        <div class="profile-info-item">
                            <label class="profile-info-label">Email</label>
                            <div class="form-group">
                                <input type="email" name="email" value="{{ user.email }}">
                            </div>
                        </div>
                    </div>

                    <!-- Informations sp√©cifiques selon le type d'utilisateur -->
                    {% if is_medecin and userEntity %}
                    <div class="profile-info" style="border-top: 2px solid var(--border-color); padding-top: 2rem; margin-top: 2rem;">
                        <h4 style="color: var(--primary-color); margin-bottom: 1.5rem;">
                            üè• Informations Professionnelles
                        </h4>
                        
                        <div class="profile-info-item">
                            <label class="profile-info-label">Sp√©cialit√©</label>
                            <div class="form-group">
                                <input type="text" name="specialty" value="{{ userEntity.specialite ?? '' }}" placeholder="Sp√©cialit√© m√©dicale">
                            </div>
                        </div>

                        <div class="profile-info-item">
                            <label class="profile-info-label">Num√©ro RPPS</label>
                            <div class="form-group">
                                <input type="text" name="rpps" value="{{ userEntity.rpps ?? '' }}" placeholder="Num√©ro RPPS">
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    {% if is_patient and userEntity %}
                    <div class="profile-info" style="border-top: 2px solid var(--border-color); padding-top: 2rem; margin-top: 2rem;">
                        <h4 style="color: var(--primary-color); margin-bottom: 1.5rem;">
                            üè• Informations de Sant√©
                        </h4>
                        
                        <div class="profile-info-item">
                            <label class="profile-info-label">Date de naissance</label>
                            <div class="form-group">
                                <input type="date" name="birthDate" 
                                       value="{% if userEntity.birthDate %}{{ userEntity.birthDate|date('Y-m-d') }}{% endif %}">
                            </div>
                        </div>

                        <div class="profile-info-item">
                            <label class="profile-info-label">Num√©ro de s√©curit√© sociale</label>
                            <div class="form-group">
                                <input type="text" name="ssn" value="{{ userEntity.ssn ?? '' }}" placeholder="Num√©ro de s√©curit√© sociale">
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    {% if is_aide_soignant and userEntity %}
                    <div class="profile-info" style="border-top: 2px solid var(--border-color); padding-top: 2rem; margin-top: 2rem;">
                        <h4 style="color: var(--primary-color); margin-bottom: 1.5rem;">
                            ü©∫ Informations Professionnelles
                        </h4>
                        
                        <div class="profile-info-item">
                            <label class="profile-info-label">Num√©ro ADELI</label>
                            <div class="form-group">
                                <input type="text" name="adeli" value="{{ userEntity.adeli ?? '' }}" placeholder="Num√©ro ADELI">
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Section mot de passe -->
                    <div class="profile-info" style="border-top: 2px solid var(--border-color); padding-top: 2rem; margin-top: 2rem;">
                        <h4 style="color: var(--warning-color); margin-bottom: 1.5rem;">
                            üîê Changer le mot de passe (optionnel)
                        </h4>
                        
                        <div class="profile-info-item">
                            <label class="profile-info-label">Mot de passe actuel</label>
                            <div class="form-group">
                                <input type="password" name="currentPassword" placeholder="Entrez votre mot de passe actuel">
                            </div>
                        </div>

                        <div class="profile-info-item">
                            <label class="profile-info-label">Nouveau mot de passe</label>
                            <div class="form-group">
                                <input type="password" name="newPassword" placeholder="Nouveau mot de passe (min 6 caract√®res)">
                            </div>
                        </div>

                        <div class="profile-info-item">
                            <label class="profile-info-label">Confirmer le mot de passe</label>
                            <div class="form-group">
                                <input type="password" name="confirmPassword" placeholder="Confirmez le nouveau mot de passe">
                            </div>
                        </div>
                    </div>

                    <!-- Boutons d'action -->
                    <div class="action-buttons" style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid var(--border-color);">
                        <button type="submit" class="btn btn--primary">
                            üíæ Enregistrer les modifications
                        </button>
                        <a href="{{ path('profile_index') }}" class="btn btn--ghost">
                            ‚ùå Annuler
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </main>
</div>
{% endblock %}
