{% extends 'base.html.twig' %}

{% block title %}Formations Disponibles
{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('assets/css/medecin/dashboard.css') }}">
{% endblock %}

{% block body %}

	{% set navigation = [
	    {'name': 'Dashboard', 'path': path('app_medecin_dashboard'), 'icon': 'üè†'},
    {'name': 'Consultations', 'path': path('medecin_consultations'), 'icon': 'ü©∫'},
    {'name': 'Formations', 'path': path('medecin_formations'), 'icon': 'üìö'},
    {'name': 'Nouvelle Formation', 'path': path('medecin_formation_new'), 'icon': '‚ûï'}
] %}

	<div
		class="portal">

		{# Sidebar #}
		{% include 'side_bar.html.twig' %}

<div class="portal">

    <!-- SIDEBAR -->
    <aside class="portal__side">

        <a href="#" class="portal__brand">
            <img src="{{ asset('assets/images/logo_mini.png') }}" class="portal__logo" alt="">
            <div>
                <div class="portal__name">Aidora</div>
                <div class="portal__tag">Espace M√©decin</div>
            </div>
        </a>

        <div class="portal__hello">
            <div class="portal__avatar">
                {{  'M' }}
            </div>
            <div>
                <div class="portal__hi">Bienvenue</div>
                <div class="portal__mail">
                    {{ app.user.name ?? 'M√©decin' }}
                </div>
            </div>
        </div>

        <nav class="portal__menu">
            {% for item in navigation %}
                <a href="{{ item.path }}"
                   class="portal__item {% if app.request.pathinfo == item.path %}is-active{% endif %}">
                    <span class="portal__icon">{{ item.icon }}</span>
                    <span>{{ item.name }}</span>
                </a>
            {% endfor %}
        </nav>

        <div class="portal__bottom">
            <a href="#" class="portal__logout">D√©connexion</a>
        </div>

    </aside>

</div>
{% endblock %}
		<main class="portal__main">
			<div class="portal__top">
				<div>
					<h1 class="portal__title">Formations Disponibles</h1>
					<p class="portal__subtitle">Consultez et explorez toutes les formations disponibles</p>
				</div>
				<a href="{{ path('medecin_formation_new') }}" class="btn btn--primary">Cr√©er une formation</a>
			</div>

			{# Filter by category #}
			<div class="filter" style="margin-bottom: 20px;">
				<form method="get" action="{{ path('aidesoignant_formations') }}">
					<label for="category">Filtrer par cat√©gorie :</label>
					<select name="category" id="category" onchange="this.form.submit()">
						<option value="">Toutes</option>
						{% for cat in categories %}
							<option value="{{ cat }}" {% if cat == selectedCategory %} selected {% endif %}>{{ cat }}</option>
						{% endfor %}
					</select>
				</form>
			</div>

			{% if formations is empty %}
				<div class="box">
					<p>Aucune formation disponible pour le moment.</p>
				</div>
			{% else %}
				<div class="cards">
					<div class="cards__grid">
						{% for formation in formations %}
							<div class="card">
								<h3>{{ formation.title }}</h3>
								<p>{{ formation.description|length > 100 ? formation.description|slice(0, 100) ~ '‚Ä¶' : formation.description }}</p>
								<div class="card__footer">
									<span class="pill">{{ formation.category }}</span>
									<span>{{ formation.startDate ? formation.startDate|date('d/m/Y') : '' }}
										-
										{{ formation.endDate ? formation.endDate|date('d/m/Y') : '' }}</span>
								</div>
								<div style="margin-top: 15px; display: flex; gap: 10px;">
									<a href="{{ path('medecin_formation_applicants', {'id': formation.id}) }}" class="btn btn--secondary" style="flex: 1; text-align: center;">
										üë• View Applicants
									</a>
								</div>
							</div>
						{% endfor %}
					</div>
				</div>
			{% endif %}
		</main>
	</div>
{% endblock %}
