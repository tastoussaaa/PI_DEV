{% extends 'base.html.twig' %}

{% block title %}Modifier mon Profil{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('assets/css/medecin/dashboard.css') }}">
{% endblock %}

{% block body %}
{% set navigation = [
    {'name': 'Dashboard', 'path': path('app_' ~ current_user_type ~ '_dashboard'), 'icon': 'üè†'},
    {'name': 'Mon Profil', 'path': path('profile_index'), 'icon': 'üë§'},
] %}

<div class="portal">
    {% include 'side_bar.html.twig' %}

    <main class="portal__main">
        <div class="portal__top">
            <div>
                <h1 class="portal__title">Modifier mon Profil</h1>
                <p class="portal__subtitle">Mettez √† jour vos informations personnelles</p>
            </div>
            <a href="{{ path('profile_index') }}" class="btn btn--ghost">Retour</a>
        </div>

        <div class="portal__content">
            {% if success %}
            <div class="pill" style="margin-bottom: 16px; color: #059669; background-color: #ecfdf5; border: 1px solid #6ee7b7;">
                ‚úì {{ success }}
            </div>
            {% endif %}

            {% if error %}
            <div class="pill" style="margin-bottom: 16px; color: #b91c1c; background-color: #fef2f2; border: 1px solid #fecaca;">
                ‚úï {{ error }}
            </div>
            {% endif %}

            <div class="box" style="max-width: 600px;">
                <form method="post" style="display: flex; flex-direction: column; gap: 16px;">
                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 8px;">Nom complet *</label>
                        <input type="text" name="fullName" value="{{ user.fullName }}" required
                               style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                    </div>

                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 8px;">Email *</label>
                        <input type="email" name="email" value="{{ user.email }}" required
                               style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                    </div>

                    {% if is_medecin and userEntity %}
                    <div style="border-top: 1px solid #e5e7eb; padding-top: 16px;">
                        <h4 style="margin-bottom: 16px;">Informations Professionnelles</h4>
                        
                        <div>
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Sp√©cialit√©</label>
                            <input type="text" name="specialty" value="{{ userEntity.specialite ?? '' }}"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>

                        <div style="margin-top: 16px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Num√©ro RPPS</label>
                            <input type="text" name="rpps" value="{{ userEntity.rpps ?? '' }}"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>
                    </div>
                    {% endif %}

                    {% if is_patient and userEntity %}
                    <div style="border-top: 1px solid #e5e7eb; padding-top: 16px;">
                        <h4 style="margin-bottom: 16px;">Informations de Sant√©</h4>
                        
                        <div>
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Date de naissance</label>
                            <input type="date" name="birthDate" 
                                   value="{% if userEntity.birthDate %}{{ userEntity.birthDate|date('Y-m-d') }}{% endif %}"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>

                        <div style="margin-top: 16px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Num√©ro de s√©curit√© sociale</label>
                            <input type="text" name="ssn" value="{{ userEntity.ssn ?? '' }}"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>
                    </div>
                    {% endif %}

                    {% if is_aide_soignant and userEntity %}
                    <div style="border-top: 1px solid #e5e7eb; padding-top: 16px;">
                        <h4 style="margin-bottom: 16px;">Informations Professionnelles</h4>
                        
                        <div>
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Num√©ro ADELI</label>
                            <input type="text" name="adeli" value="{{ userEntity.adeli ?? '' }}"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>
                    </div>
                    {% endif %}

                    <div style="border-top: 1px solid #e5e7eb; padding-top: 16px;">
                        <h4 style="margin-bottom: 16px;">Changer le mot de passe (optionnel)</h4>
                        
                        <div>
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Mot de passe actuel</label>
                            <input type="password" name="currentPassword"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>

                        <div style="margin-top: 16px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Nouveau mot de passe</label>
                            <input type="password" name="newPassword"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>

                        <div style="margin-top: 16px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px;">Confirmer le mot de passe</label>
                            <input type="password" name="confirmPassword"
                                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #d0d7de;">
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px; margin-top: 24px; border-top: 1px solid #e5e7eb; padding-top: 16px;">
                        <button type="submit" class="btn btn--primary">Enregistrer les modifications</button>
                        <a href="{{ path('profile_index') }}" class="btn btn--ghost">Annuler</a>
                    </div>
                </form>
            </div>
        </div>
    </main>
</div>
{% endblock %}
